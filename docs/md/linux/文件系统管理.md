# 文件系统管理

## 分区和文件系统

- 主分区:总共最多只能分四个
- 扩展分区:只能有一个，也算作主分区的一种，也就是说主分区加扩展分区最多有四个。但是扩展分区不能存储数据和格式化，必须再划分成逻辑分区才能使用。
- 逻辑分区:逻辑分区是在扩展分区中划分的，如果是IDE硬盘，Linux最多 支持59个逻辑分区，如果是SCSI硬盘Linux最多支持11个逻辑分区

![alt text](images/文件系统管理/image.png)

| 分区的设备文件名 |           |
| ---------------- | --------- |
| 主分区1          | /dev/sdal |
| 主分区2          | /dev/sda2 |
| 主分区3          | /dev/sda3 |
| 扩展分区         | /dev/sda4 |
| 逻辑分区1        | /dev/sda5 |
| 逻辑分区2        | /dev/sda6 |
| 逻辑分区3        | /dev/sda7 |

![alt text](images/文件系统管理/image-1.png)

| 分区的设备文件名 |           |
| ---------------- | --------- |
| 主分区1          | /dev/sdal |
| 扩展分区         | /dev/sda2 |
| 逻辑分区1        | /dev/sda5 |
| 逻辑分区2        | /dev/sda6 |
| 逻辑分区3        | /dev/sda7 |

## 文件系统

- ext2:是ext文 件系统的升级版本，Red Hat Linux7.2版本以前的系统默认都是ext2文件系统。1993年发布，最大支持16TB的分区和最大2TB的文件(1TB= 1024GB= 1024*1024MB )
- ext3: ext3文 件系统是ext2文件系统的升级版本，最大的区别就是带日志功能，以在系统突然停止时提高文件系统的可靠性支持最大16TB的分区和最大2TB的文件。
- ext4:它是ext3文件系统的升级版。ext4 在性能、伸缩性和可靠性方面进行了大量改进。EXT4的变化可以说是翻天覆地的，比如向下兼容EXT3、最大1EB文件系统和16TB文件、无限数量子目录、Extents连续数据块概念、多块分配、延迟分配、持久预分配、快速FSCK、日志校验、无日志模式、在线碎片整理、inode增 强、默认启用barrier等。是CentOS 6.3的默认文件系统( 1EB= 1024PB= 1024*1024TB )

## 文件系统常用命令

文件系统查看命令`df [选项] [挂载点]`
选项:

1. -a：显示所有的文件系统信息，包括特殊文件系统，如/proc、/sysfs
2. -h ：使用习惯单位显示容量，如KB，MB或GB等
3. -T：显示文件系统类型
4. -m：以MB为单位显示容量
5. -k：以KB为单位显示容量。默认就是以KB为单位

统计目录或文件大小`du [选项][目录或文件名]`
选项:

1. -a：显示每个子文件的磁盘占用量。默认只统计子目录的磁盘占用量
2. -h：使用习惯单位显示磁盘占用量，如KB，MB或GB等
3. -S：统计总占用量，而不列出子目录和子文件的占用量
   - df命令是从文件系统考虑的，不光要考虑文件占用的空间，还要统计被命令或程序占用的空间(最常见的就是文件已经删除，但是程序并没有释放空间)
   - du命令是面向文件的，只会计算文件或目录占用的空间

文件系统修复命令（开机自动）`fsck [选项]分区设备文件名`
选项:

1. -a:不用显示用户提示，自动修复文件系统
2. -y:自动修复。和-a作用一-致，不过有些文件系统只支持-y

显示磁盘状态命令`dumpe2fs 分区设备文件名`

## 挂载命令格式

`[root@localhost ~]# mount [-t文件统][-L卷标名] [-o特殊选项] 设备文件名挂载点`
选项:

- -t文件系统：加入文件系统类型来指定挂载的类型，可以ext3、ext4、iso9660等文件系统
- -L卷标名：挂载指定卷标的分区，而不是安装设备文件名挂载
- -0特殊选项：可以指定挂载的额外选项

| 参数          | 说明                                                                                        |
| ------------- | ------------------------------------------------------------------------------------------- |
| atime/noatime | 更新访问时间不更新访问时间。访问分区文件时，是否更新文件的访问时间，默认为更新              |
| async/sync    | 异步/同步，默认为异步                                                                       |
| auto/noauto   | 自动/手动，mount-a命令执行时，是否会自动安装/etc/fstab文件内容挂载，默认为自动              |
| defaults      | 定义默认值，相当于rw,suid,dev,exec,auto,nouser,async这七个选项                            |
| exec/noexec   | 执行/不执行，设定是否允许在文件系统中执行可执行文件，默认是exec允许                         |
| remount       | 重新挂载已经挂载的文件系统，一般用于指定修改特殊权限                                        |
| rw/ro         | 读写/只读，文件系统挂载时，是否具有读写权限，默认是rw                                       |
| suid/nosuid   | 具有不具有SUD权限，设定文件系统是否具有SUID和SGD的权限，默认是具有                          |
| user/nouser   | 允许不允许普通用户挂载，设定文件系统是否允许普通用户挂载，默认是不允许，只有root可以挂载分区 |
| usrquota      | 写入代表文件系统支持用户磁盘配额，默认不支持                                                |
| grpquota      | 写入代表文件系统支持组磁盘配额，默认不支持                                                  |

系统创建了/mnt和/mid分别挂载U盘和光盘

挂载U盘
`[root@localhost ~]# fdisk -l`
> 查看U盘设备文件名
`[root@localhost ~]# mount -t vfat /dev/sdb /mnt/usb/`
>注意: Linux默认是不支持NTFS文件系统的

修改linux的NTFS文件系统使其可访问
第一种，重编内核重新加入NTFS
第二种，使用第三方插件